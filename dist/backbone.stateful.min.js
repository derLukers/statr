define("State",["StateManager"],function(t){"use strict";var e,r,n;return n=function(t,e){var r,n,i;n=t;for(r in e)i=e[r],n=n.replace(":"+r,i);return n},r=function(){var t;return t={},t.promise=new Promise(function(e,r){return t.resolve=e,t.reject=r}),t},e=function(){function e(){t.registerState(this)}return e.prototype.isActive=!1,e.prototype.insertParameters=n,e.prototype.doResolve=function(t,e){var r;return null==e&&(e={}),r=new Promise(function(n){return function(i){var o,u,a,s,c;if(n.resolve){s=[],c=n.resolve;for(u in c)a=c[u],o=a(t,e),o.name=u,s.push(o);return Promise.all(s).then(function(){var t,r;for(t in s)r=s[t],e[r.name]=arguments[t];return i(e)})}return i(e),r}}(this))},e.prototype.activate=function(t,e,n){var i,o,u;return null==e&&(e=null),null==n&&(n=r()),i=null===e,o=r(),i&&o.promise.then(function(t){return n.resolve(t)}),this.currentChild!==e&&(null!=(u=this.currentChild)&&u.deactivate(),this.currentChild=e),this.isActive&&this.generateRoute(this.currentParameters)===this.generateRoute(t)?o.resolve(this.previousResolveResult):this.parent?this.parent.activate(t,this,n).then(function(e){return function(r){return e.doResolve(t,r).then(function(t){return e.previousResolveResult=t,o.resolve(t)})}}(this)):this.doResolve(t).then(function(t){return function(e){return t.previousResolveResult=e,o.resolve(e)}}(this)),n.promise.then(function(r){return function(n){return r.currentChild=e,r.isActive=!0,"function"==typeof r.onActivate?r.onActivate(t,n):void 0}}(this)),this.currentParameters=t,o.promise},e.prototype.deactivate=function(){var t;return this.isActive=!1,"function"==typeof this.onDeactivate&&this.onDeactivate(),null!=(t=this.currentChild)&&t.deactivate(),this.currentChild=null},e.prototype.generateRoute=function(t){var e;return""+[(null!=(e=this.parent)?e.generateRoute(t).length:void 0)?this.parent.generateRoute(t)+"/":void 0]+(""+[this.route?n(this.route,t):void 0])},e.prototype.generateRouteString=function(){var t;return""+[(null!=(t=this.parent)?t.generateRouteString().length:void 0)?""+this.parent.generateRouteString()+(this.route?"/":void 0):void 0]+[this.route]},e.prototype.generateName=function(){var t;return""+[(null!=(t=this.parent)?t.statename:void 0)?this.parent.generateName()+".":void 0]+this.statename},e.prototype.getParentChain=function(){var t,e;return t=(null!=(e=this.parent)?e.getParentChain():void 0)||[],t.push(this),t},e}()}),define("StateManager",["backbone"],function(t){var e;return new(e=function(){function e(){this.clear()}var r,n;return n={},r=null,e.prototype.router=new t.Router,e.prototype.go=function(t,e,i){var o;if(null==e&&(e={}),null==i&&(i={navigate:!0}),!n[t])throw new Error('No State with name "'+t+"' found.");return o=n[t],o.activate(e),r=o,i.navigate&&!o.abstract&&o.route?this.router.navigate(o.generateRoute(e)):void 0},e.prototype.registerState=function(t){var e;if(e=t.generateName(),n[t.generateName()])throw new Error('State with name "'+e+'" already exists.');return n[t.generateName()]=t,!t.route&&""!==t.route||t.abstract?void 0:this.router.route(t.generateRouteString(),t.generateName(),function(){var r,n,i,o,u,a;for(i=arguments,n={},a=t.generateRouteString().match(/:([a-zA-Z0-9\-_]+)/g),r=o=0,u=a.length;u>o;r=++o)e=a[r],n[e.substring(1)]=i[r];return t.activate(n)})},e.prototype.getState=function(t){return n[t]},e.prototype.clear=function(){return null!=r&&r.getParentChain()[0].deactivate(),n={}},e}())});