define("State",["StateManager"],function(t){"use strict";var e,r;return r=function(){var t;return t={},t.promise=new Promise(function(e,r){return t.resolve=e,t.reject=r}),t},e=function(){function e(){t.registerState(this)}return e.prototype.isActive=!1,e.prototype.activationHooks=[],e.prototype.doResolve=function(t,e){var n,i,o,u,a,s;if(null==e&&(e={}),a=r(),!this.resolve)return a.resolve(e),a.promise;s=[],i=this.resolve;for(n in i)o=i[n],u=o(t,e)||{},u.name=n,s.push(u);return Promise.all(s).then(function(t){return function(){var r,n;for(r in s)n=s[r],e[n.name]=arguments[r];return t.previousResolveResult=e,a.resolve(e)}}(this)),a.promise},e.prototype.activate=function(t,e,n){var i,o,u,a,s;return null==e&&(e=null),null==n&&(n=r()),o=null===e,u=r(),i=r(),this.currentChild!==e&&(null!=(s=this.currentChild)&&s.deactivate(),this.currentChild=e),o&&u.promise.then(n.resolve,n.reject),u.promise.then(function(t){return function(e){return t.previousResolveResult=e}}(this)),i.promise.then(function(r){return function(){return r.currentChild=e,r.isActive=!0,r.currentParams=t}}(this)),this.isActive&&this.paramsUnchanged(t)?(u.resolve(this.previousResolveResult),n.promise.then(i.resolve,i.reject)):this.parent?(a=this.parent.activate(t,this,n),a[0].then(function(e){return function(r){return e.doResolve(t,r).then(u.resolve,u.reject)}}(this)),a[1].then(function(e){return function(r){return e.executeActivationHooks(t,r).then(i.resolve,i.reject)}}(this))):(this.doResolve(t).then(u.resolve),n.promise.then(function(e){return function(r){return e.executeActivationHooks(t,r).then(i.resolve,i.reject)}}(this))),o?i.promise:[u.promise,i.promise]},e.prototype.paramsUnchanged=function(t,e){var r,n;return null==e&&(e=this.currentParams||{}),t?[function(){var i,o,u;for(u=[],n=i=0,o=e.length;o>i;n=++i)r=e[n],u.push(t[r]===n);return u}()].every(function(t){return t===!0}):!0},e.prototype.executeActivationHooks=function(t,e){var r,n;return n=[function(){var n,i,o,u;for(o=this.activationHooks,u=[],n=0,i=o.length;i>n;n++)r=o[n],u.push(r(t,e));return u}.call(this)],Promise.all(n)},e.prototype.deactivate=function(){var t;return this.isActive=!1,null!=(t=this.currentChild)&&t.deactivate(),"function"==typeof this.onDeactivate&&this.onDeactivate(),this.currentChild=null},e.prototype.onActivate=function(t){return this.activationHooks.push(t)},e.prototype.generateName=function(){var t;return""+[(null!=(t=this.parent)?t.statename:void 0)?this.parent.generateName()+".":void 0]+this.statename},e.prototype.getParentChain=function(){var t,e;return t=(null!=(e=this.parent)?e.getParentChain():void 0)||[],t.push(this),t},e}()}),define("StateManager",[],function(){var t;return new(t=function(){function t(){this.clear()}var e,r;return r={},e=null,t.prototype.go=function(t,n){var i;if(null==n&&(n={}),!r[t])throw new Error('No State with name "'+t+'" found.');return i=r[t],e=i,i.activate(n)},t.prototype.registerState=function(t){var e;if(e=t.generateName(),r[t.generateName()])throw new Error('State with name "'+e+'" already exists.');return r[t.generateName()]=t},t.prototype.getState=function(t){return r[t]},t.prototype.clear=function(){return null!=e&&e.getParentChain()[0].deactivate(),r={}},t}())});